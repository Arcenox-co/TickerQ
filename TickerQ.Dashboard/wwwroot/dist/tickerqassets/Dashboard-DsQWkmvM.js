const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["tickerqassets/ConfirmDialog-CY5nDLOI.js","tickerqassets/_plugin-vue_export-helper-CEavA9-_.js","tickerqassets/index-Byj9w34-.js","tickerqassets/index-9ePG4d-9.css","tickerqassets/_plugin-vue_export-helper-BbU2hx5y.css"])))=>i.map(i=>d[i]);
import{d as Z,r as w,_ as ee,o as te,a as se,c as oe,w as ne,b as _,e as t,f as s,u as o,F as B,g as u,h as p,i,j as O,k as d,l as L,t as v,m as ae}from"./index-Byj9w34-.js";import{t as f,u as le,a as re,T as g,S as ie,m as D,C as ce,f as ue,_ as de}from"./_plugin-vue_export-helper-CEavA9-_.js";import{s as pe}from"./sleep-B8FjgEV9.js";const me={key:0},ve={key:1},_e={key:2},fe={class:"pt-4"},ge={class:"pt-4"},xe={class:"pt-4"},ye={class:"pt-4"},ke={class:"pt-4"},be={class:"pt-4"},we={class:"pt-4"},Ce={class:"text-truncate",style:{"max-width":"200px"}},Te={class:"text-right"},Ae={key:0},De={key:1},Se={key:2},Ne=Z({__name:"Dashboard",setup(Re){const C=f.getNextPlannedTicker(),q=f.stopTicker(),h=f.startTicker(),T=f.restartTicker(),W=f.getTickerHostStatus(),x=f.getOptions(),Q=f.getMachineJobs(),y=f.getJobStatusesPastWeek(),U=f.getJobStatusesOverall(),j=le(),S=w(0),k=w(!1),b=re().withComponent(()=>ee(()=>import("./ConfirmDialog-CY5nDLOI.js"),__vite__mapDeps([0,1,2,3,4])));te(async()=>{await g.startConnection(),await C.requestAsync(),await x.requestAsync(),await U.requestAsync().then(n=>{const e=n.reduce((r,m)=>r+m.item2,0);n.forEach(r=>{const m=H.value.find(l=>l.name===ie[r.item1]);if(m){m.count=r.item2;const l=(r.item2/e*100).toFixed(1);m.percentage=l.endsWith(".0")?l.slice(0,-2):l}})}),await y.requestAsync(),await Q.requestAsync().then(n=>{n.forEach(e=>{P.value.push({machine:e.item1,locked:`${e.item2} Jobs`})})}),await j.loadData().then(n=>{var e;(e=n.value)==null||e.forEach(r=>{const m=r.functionRequestNamespace==""?"N/A":r.functionRequestNamespace;F.value.push({function:r.functionName,request:m,priority:X[r.priority]})})}),await W.requestAsync().then(n=>{k.value=n.isRunning}),g.onReceiveThreadsActive(n=>{S.value=n}),g.onReceiveNextOccurrence(n=>{C.updateProperty("nextOccurrence",n)}),g.onReceiveHostStatus(n=>{k.value=n}),g.onReceiveHostExceptionMessage(n=>{x.updateProperty("lastHostExceptionMessage",n)})}),se(()=>{g.stopReceiver(D.onReceiveThreadsActive),g.stopReceiver(D.onReceiveNextOccurrence),g.stopReceiver(D.onReceiveHostStatus),g.stopReceiver(D.onReceiveHostExceptionMessage)});const H=w([{name:"Idle",count:0,percentage:"0"},{name:"Queued",count:0,percentage:"0"},{name:"InProgress",count:0,percentage:"0"},{name:"Done",count:0,percentage:"0"},{name:"DueDone",count:0,percentage:"0"},{name:"Failed",count:0,percentage:"0"},{name:"Cancelled",count:0,percentage:"0"}]),G=oe(()=>{var n,e;return((e=(n=x.response)==null?void 0:n.value)==null?void 0:e.lastHostExceptionMessage)&&x.response.value.lastHostExceptionMessage!==""}),N=w(!1);ne(()=>{var n;return S.value===((n=x.response.value)==null?void 0:n.maxConcurrency)},n=>{n?N.value=!0:setTimeout(()=>{N.value=!1},3e3)},{immediate:!0});const K={Idle:"#A9A9A9",Queued:"#00CED1",InProgress:"#6495ED",Done:"#32CD32",DueDone:"#008000",Failed:"#FF0000",Cancelled:"#FFD700"},P=w([]),X={0:"LongRunning",1:"High",2:"Normal",3:"Low"},F=w([]);return(n,e)=>{const r=u("v-btn"),m=u("v-divider"),l=u("v-list-item-subtitle"),J=u("v-icon"),R=u("v-list-item"),c=u("v-col"),A=u("v-row"),E=u("v-container"),$=u("v-card"),I=u("v-card-title"),V=u("v-data-table"),Y=u("v-progress-linear"),M=u("v-alert");return p(),_(B,null,[t(E,{fluid:""},{default:s(()=>[t(A,null,{default:s(()=>[t(c,{cols:"8"},{default:s(()=>[t($,{class:"mx-auto"},{title:s(()=>[e[5]||(e[5]=i(" Actions: ")),k.value?O("",!0):(p(),_("span",me,[t(r,{class:"mx-2",rounded:"lg",size:"xl",variant:"outlined",color:"success",icon:"mdi-play",onClick:e[0]||(e[0]=a=>o(h).requestAsync()),loading:o(h).loader.value},null,8,["loading"])])),k.value?(p(),_("span",ve,[t(r,{class:"mx-2",rounded:"lg",size:"xl",variant:"outlined",color:"error",icon:"mdi-stop",onClick:e[1]||(e[1]=a=>o(b).open({...new(o(ce)),confirmText:"Stop"})),loading:o(q).loader.value},null,8,["loading"])])):O("",!0),k.value?(p(),_("span",_e,[t(r,{class:"mx-2",rounded:"lg",size:"xl",variant:"outlined",color:"warning",icon:"mdi-restart",onClick:e[2]||(e[2]=a=>{o(T).requestAsync().then(async()=>{o(T).loader.value=!0,await o(pe)(1e3).then(()=>{o(T).loader.value=!1})})}),loading:o(T).loader.value},null,8,["loading"])])):O("",!0)]),default:s(()=>[t(m),e[19]||(e[19]=d("div",{class:"v-card-title",style:{opacity:"var(--v-list-item-subtitle-opacity, var(--v-medium-emphasis-opacity))"}}," Overview ",-1)),t(E,{fluid:""},{default:s(()=>[t(A,null,{default:s(()=>[t(c,{cols:"3"},{default:s(()=>[k.value?(p(),L(R,{key:0,class:"w-100"},{default:s(()=>[t(l,{class:"mb-2"},{default:s(()=>e[6]||(e[6]=[i(" Status: ")])),_:1}),t(J,{color:"green",class:""},{default:s(()=>e[7]||(e[7]=[i("mdi-check-circle-outline ")])),_:1}),e[8]||(e[8]=d("span",{class:"pt-4 mx-2"},"Active",-1))]),_:1})):(p(),L(R,{key:1,class:"w-100"},{default:s(()=>[t(l,{class:"mb-2"},{default:s(()=>e[9]||(e[9]=[i(" Status: ")])),_:1}),t(J,{color:"red",class:""},{default:s(()=>e[10]||(e[10]=[i("mdi-stop-circle-outline ")])),_:1}),e[11]||(e[11]=d("span",{class:"pt-4 mx-2"},"Stopped",-1))]),_:1}))]),_:1}),t(c,{cols:"3"},{default:s(()=>[t(l,{class:"mb-2"},{default:s(()=>e[12]||(e[12]=[i(" Success Jobs (past 7 days)")])),_:1}),d("span",fe,v(o(y).response.value!=null?o(y).response.value[0].item2:0),1)]),_:1}),t(c,{cols:"3"},{default:s(()=>[t(l,{class:"mb-2"},{default:s(()=>e[13]||(e[13]=[i(" Failed Jobs (past 7 days)")])),_:1}),d("span",ge,v(o(y).response.value!=null?o(y).response.value[1].item2:0),1)]),_:1}),t(c,{cols:"3"},{default:s(()=>[t(l,{class:"mb-2"},{default:s(()=>e[14]||(e[14]=[i(" Total Jobs (past 7 days)")])),_:1}),d("span",xe,v(o(y).response.value!=null?o(y).response.value[2].item2:0),1)]),_:1})]),_:1}),t(m,{class:"my-2"}),t(A,{class:"mt-3"},{default:s(()=>[t(c,{cols:"3"},{default:s(()=>[t(R,{class:"w-100"},{default:s(()=>{var a,z;return[t(l,{class:"mb-2"},{default:s(()=>e[15]||(e[15]=[i(" Next Occurrence: ")])),_:1}),d("span",ye,v(((a=o(C).response.value)==null?void 0:a.nextOccurrence)==null?"N/A":o(ue)((z=o(C).response.value)==null?void 0:z.nextOccurrence)),1)]}),_:1})]),_:1}),t(c,{cols:"3"},{default:s(()=>{var a;return[t(l,{class:"mb-2"},{default:s(()=>e[16]||(e[16]=[i(" Max Concurrency: ")])),_:1}),d("span",ke,v((a=o(x).response.value)==null?void 0:a.maxConcurrency),1)]}),_:1}),t(c,{cols:"3"},{default:s(()=>[t(l,{class:"mb-2"},{default:s(()=>e[17]||(e[17]=[i(" Active Threads: ")])),_:1}),d("span",be,v(S.value),1)]),_:1}),t(c,{cols:"3"},{default:s(()=>{var a;return[t(l,{class:"mb-2"},{default:s(()=>e[18]||(e[18]=[i(" Current Machine: ")])),_:1}),d("span",we,v((a=o(x).response.value)==null?void 0:a.currentMachine),1)]}),_:1})]),_:1})]),_:1})]),_:1}),t(A,{class:"mt-2"},{default:s(()=>[t(c,{cols:"8"},{default:s(()=>[t(I,null,{default:s(()=>e[20]||(e[20]=[i(" Declared Functions ")])),_:1}),t(V,{"hide-default-footer":"",density:"compact",items:F.value},{"item.request":s(({item:a})=>[d("div",Ce,v(a.request),1)]),_:1},8,["items"])]),_:1}),t(c,{cols:"4"},{default:s(()=>[t(I,null,{default:s(()=>e[21]||(e[21]=[i(" Used Machines ")])),_:1}),t(V,{"hide-default-footer":"",density:"compact",items:P.value},null,8,["items"])]),_:1})]),_:1})]),_:1}),t(c,{cols:"4"},{default:s(()=>[t($,{class:"mx-auto",subtitle:"Time and Cron Tickers",title:"Status Overview"},{default:s(()=>[t(E,{fluid:""},{default:s(()=>[(p(!0),_(B,null,ae(H.value,a=>(p(),_("div",null,[d("span",null,v(`${a.name} (${a.count})`),1),t(Y,{color:K[a.name],"model-value":a.percentage,rounded:""},null,8,["color","model-value"]),d("div",Te,v(a.percentage)+"%",1)]))),256))]),_:1})]),_:1})]),_:1}),t(c,{cols:"8"},{default:s(()=>[t(M,{color:"#212121",title:"Core Alerts:"},{text:s(()=>{var a;return[G.value?(p(),_("span",Ae,[t(M,{class:"mt-4",color:"red",icon:"mdi-close-circle",text:`Error Message: ${(a=o(x).response.value)==null?void 0:a.lastHostExceptionMessage} `},null,8,["text"])])):N.value?(p(),_("span",De,[t(M,{class:"mt-4",icon:"mdi-alert-circle-outline",color:"warning",text:"All worker threads are currently active. To avoid task delays, consider optimizing task execution or increasing the maximum concurrency setting."})])):(p(),_("span",Se," - "))]}),_:1})]),_:1})]),_:1})]),_:1}),t(o(b).Component,{"is-open":o(b).isOpen,onClose:e[3]||(e[3]=a=>o(b).close()),"dialog-props":o(b).propData,onConfirm:e[4]||(e[4]=a=>o(q).requestAsync().then(()=>{o(b).close(),o(C).updateProperty("nextOccurrence",void 0)}))},null,8,["is-open","dialog-props"])],64)}}}),qe=de(Ne,[["__scopeId","data-v-e4eba0ae"]]);export{qe as default};
