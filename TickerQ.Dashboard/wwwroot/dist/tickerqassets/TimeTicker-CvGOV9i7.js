const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["tickerqassets/CRUDTimeTickerDialogComponent-Bu2ebCRb.js","tickerqassets/_plugin-vue_export-helper-CEavA9-_.js","tickerqassets/index-Byj9w34-.js","tickerqassets/index-9ePG4d-9.css","tickerqassets/_plugin-vue_export-helper-BbU2hx5y.css","tickerqassets/useCustomForm-CiMEJ6Pp.js","tickerqassets/index-BXjI2TNL.js","tickerqassets/index-BojVbZw0.js","tickerqassets/CRUDTimeTickerDialogComponent-BiL9-BlM.css","tickerqassets/ConfirmDialog-CY5nDLOI.js","tickerqassets/TickerRequestDialog-CfbuU56C.js","tickerqassets/TickerRequestDialog-BkemuCzU.css"])))=>i.map(i=>d[i]);
var Ae=Object.defineProperty;var be=(c,u,f)=>u in c?Ae(c,u,{enumerable:!0,configurable:!0,writable:!0,value:f}):c[u]=f;var p=(c,u,f)=>be(c,typeof u!="symbol"?u+"":u,f);import{d as xe,_ as V,r as G,o as De,a as Ce,n as he,c as L,w as we,b as g,e as i,f as r,u as t,F as ce,p as Ie,g as A,h as v,k as m,i as C,q as z,t as b,l as U,j as Q,s as Re,m as qe}from"./index-Byj9w34-.js";import{u as Ee,b as $,S as n,c as ue,f as te,t as Pe,a as j,T as q,m as Z,d as ee,C as Se,_ as Fe}from"./_plugin-vue_export-helper-CEavA9-_.js";import{n as B,u as $e,i as Ne,a as Oe,b as Ge,c as Me,d as He,e as Ve,f as Le,g as ze,E as de,T as Ue}from"./index-BXjI2TNL.js";import{f as Qe}from"./index-BojVbZw0.js";class je{constructor(){p(this,"id");p(this,"function");p(this,"status");p(this,"retries");p(this,"retryCount");p(this,"retryIntervals");p(this,"description");p(this,"requestType");p(this,"lockHolder");p(this,"lockedAt");p(this,"executionTime");p(this,"executionTimeFormatted");p(this,"createdAt");p(this,"updatedAt");p(this,"executedAt");p(this,"elapsedTime");p(this,"actions");p(this,"exception")}}class Be{constructor(){p(this,"date");p(this,"results")}}const Je=()=>{const c=Ee(),u=$("array").FixToResponseModel(je,o=>(o.status=n[o.status],(o.executedAt!=null||o.executedAt!=null)&&(o.executedAt=`${Qe(o.executedAt)} (took ${ue(o.elapsedTime,!0)})`),o.executionTimeFormatted=te(o.executionTime),o.requestType=c.getNamespaceOrNull(o.function)??"N/A",o.description=o.description==""?"N/A":o.description,o.retryIntervals==null||o.retryIntervals.length==0&&o.retries!=null&&o.retries>0?o.retryIntervals=Array(1).fill("30s"):o.retryIntervals=o.retryIntervals.map(l=>ue(l,!1)),o.lockHolder=o.lockHolder??"N/A",o)).FixToHeaders(o=>(B(l=>l.actions)==o.key&&(o.sortable=!1),B(l=>l.id,l=>l.exception,l=>l.retries,l=>l.lockedAt,l=>l.createdAt,l=>l.updatedAt,l=>l.retryCount,l=>l.elapsedTime,l=>l.executionTime).includes(o.key)&&(o.visibility=!1),B(l=>l.executedAt)==o.key&&(o.title="Executed At (Elapsed Time)"),B(l=>l.executionTimeFormatted)==o.key&&(o.title="Execution Time"),o)).ReOrganizeResponse(o=>o.sort((l,K)=>new Date(K.executionTime).getTime()-new Date(l.executionTime).getTime()));return{...u,requestAsync:async()=>await u.sendAsync("GET","time-tickers")}},Ke=()=>{const c=$("array").FixToResponseModel(Be,f=>({...f,date:te(f.date,!1)}));return{...c,requestAsync:async(f,o)=>await c.sendAsync("GET","time-tickers/:graph-data-range",{paramData:{pastDays:f,futureDays:o}})}},We=()=>{const c=$("array");return{...c,requestAsync:async()=>await c.sendAsync("GET","time-tickers/:graph-data")}},Ye=()=>{const c=$("single");return{...c,requestAsync:async f=>await c.sendAsync("DELETE","time-ticker/:delete",{paramData:{id:f}})}},Xe=()=>{const c=$("single");return{...c,requestAsync:async f=>await c.sendAsync("POST","time-ticker/:add",{bodyData:f})}},Ze=()=>{const c=$("single");return{...c,requestAsync:async(f,o)=>await c.sendAsync("PUT","time-ticker/:update",{bodyData:o,paramData:{id:f}})}},J={getTimeTickers:Je,deleteTimeTicker:Ye,getTimeTickersGraphDataRange:Ke,getTimeTickersGraphData:We,addTimeTicker:Xe,updateTimeTicker:Ze},et={class:"scrollable-container bg-surface-light"},tt={class:"d-flex justify-end px-4 mb-2"},st=["onClick"],at=["onClick"],nt={key:0,class:"snippet","data-title":"dot-carousel"},ot={key:1},rt={key:0},lt={key:1},it={class:"attempt"},ct={key:0},ut={key:0},dt={key:0},pt={key:0,class:"attempt"},mt={key:1},yt={class:"attempt"},vt={key:2},ft={key:3},gt={key:1},Tt={key:2},kt={class:"attempt"},_t=xe({__name:"TimeTicker",setup(c){const u=J.getTimeTickers(),f=J.deleteTimeTicker(),o=Pe.requestCancel(),l=J.getTimeTickersGraphDataRange(),K=J.getTimeTickersGraphData(),x=j().withComponent(()=>V(()=>import("./CRUDTimeTickerDialogComponent-Bu2ebCRb.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),E=j().withComponent(()=>V(()=>import("./ConfirmDialog-CY5nDLOI.js"),__vite__mapDeps([9,1,2,3,4]))),P=j().withComponent(()=>V(()=>import("./TickerRequestDialog-CfbuU56C.js"),__vite__mapDeps([10,1,2,3,4,11]))),N=j().withComponent(()=>V(()=>import("./ConfirmDialog-CY5nDLOI.js"),__vite__mapDeps([9,1,2,3,4]))),se=G(new Map),ae=G(null);De(async()=>{await q.startConnection(),await u.requestAsync(),await oe(S.value[0],S.value[1]),await me(),await pe()}),Ce(()=>{q.stopReceiver(Z.onReceiveAddTimeTicker),q.stopReceiver(Z.onReceiveUpdateTimeTicker),q.stopReceiver(Z.onReceiveDeleteTimeTicker)});const pe=async()=>{q.onReceiveAddTimeTicker(a=>{u.addToResponse(a)}),q.onReceiveUpdateTimeTicker(a=>{var s;u.updateByKey("id",a,["requestType"]),x.isOpen&&((s=x.propData)==null?void 0:s.id)==a.id&&(x.setPropData({...a,executionTime:ee(a.executionTime),isFromDuplicate:!1}),he(()=>{var y;(y=ae.value)==null||y.resetForm()}))}),q.onReceiveDeleteTimeTicker(a=>{u.removeFromResponse("id",a)})},ne=()=>{x.close()},me=async()=>{await K.requestAsync().then(a=>{const s=a.sort((y,k)=>y.item2-k.item2).map(y=>({name:`${n[y.item1]} (${y.item2})`,value:y.item2,itemStyle:{color:M[n[y.item1]]||"#999"}}));re.value.series[0].data=s})},oe=async(a,s)=>{await l.requestAsync(a,s).then(y=>{const k=y.map(d=>d.date);H.value.xAxis.data=k;const O=new Set;y.forEach(({results:d})=>{d.forEach(({item1:D})=>O.add(D))});const W=Array.from(O),F=new Map;W.forEach(d=>{F.set(d,Array(k.length).fill(0))}),y.forEach(({date:d,results:D})=>{const X=k.indexOf(d);D.forEach(({item1:e,item2:_})=>{const R=F.get(e);R&&(R[X]=_)})});const w=Array.from(F.entries()).map(([d,D])=>({data:D,name:n[d]||`Unknown ${d}`,type:"line",lineStyle:{color:M[n[d]]},itemStyle:{color:M[n[d]]}})),I=["Idle","Queued","InProgress","Done","DueDone","Failed","Cancelled"],Y=w.filter(d=>d.data.some(D=>D>0)).map(d=>d.name);H.value.legend={show:!0,textStyle:{color:"#fff"},selected:Object.fromEntries(I.map(d=>[d,Y.includes(d)]))},H.value.series=w})},T=(a,s)=>a==n[s],ye=a=>{se.value.set(P.propData.id,a)},ve=L(()=>Array.from(se.value.entries()).map((a,s)=>{if(a[1]==0)return{id:a[0],icon:"mdi-delete-alert",color:"#212121",class:"grey-badge"};if(a[1]==1)return{id:a[0],icon:"mdi-check-decagram",color:"#212121",class:"blue-badge"};if(a[1]==2)return{id:a[0],icon:"mdi-alert-decagram",color:"#212121",class:"red-badge"}})),M={Idle:"#A9A9A9",Queued:"#00CED1",InProgress:"#6495ED",Done:"#32CD32",DueDone:"#008000",Failed:"#FF0000",Cancelled:"#FFD700"},fe=async a=>{await o.requestAsync(a)},ge=async()=>{var a;E.close(),await f.requestAsync((a=E.propData)==null?void 0:a.id)},Te=a=>({style:`color:${M[a.item.status]}`});$e([Ne,Oe,Ge,Me,He,Ve,Le,ze]),Ie(Ue,"dark");const H=G({backgroundColor:"#212121",tooltip:{trigger:"axis"},legend:{show:!0,textStyle:{color:"#fff"},selected:{}},grid:{left:"3%",right:"3%",bottom:"3%",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!1,data:[],axisLabel:{color:"#ccc"},axisLine:{lineStyle:{color:"#666"}}},yAxis:{type:"value",min:0,axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!0,lineStyle:{color:"#444",width:1}}},series:[]}),re=G({backgroundColor:"#212121",title:{text:"Total Time Tickers",subtext:"Pie chart of job statuses",left:"center",top:"top",textStyle:{color:"#fff",fontSize:20,fontWeight:"bold"},subtextStyle:{color:"#aaa",fontSize:14}},tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{show:!1},series:[{type:"pie",radius:["40%","70%"],center:["50%","100%"],startAngle:180,endAngle:360,data:[]}]}),S=G([-3,3]),h=L({get:()=>S.value,set:([a,s])=>{a=Math.max(-10,Math.min(a,-1)),s=Math.max(1,Math.min(s,10)),a>=s&&(a=-1,s=1),S.value=[a,s]}}),le=L({get:()=>h.value[0],set:a=>{h.value=[a||-1,h.value[1]]}}),ie=L({get:()=>h.value[1],set:a=>{h.value=[h.value[0],a||1]}});function ke(a,s){let y;return(...k)=>{clearTimeout(y),y=setTimeout(()=>a(...k),s)}}const _e=ke(async([a,s])=>{await oe(a,s)},100);return we(()=>S.value.toString(),()=>{_e([...S.value])},{immediate:!0,flush:"post"}),(a,s)=>{const y=A("v-sheet"),k=A("v-col"),O=A("v-text-field"),W=A("v-range-slider"),F=A("v-row"),w=A("v-btn"),I=A("v-icon"),Y=A("v-badge"),d=A("v-tooltip"),D=A("v-data-table"),X=A("v-container");return v(),g(ce,null,[i(X,{fluid:""},{default:r(()=>[i(F,null,{default:r(()=>[i(k,{cols:"12"},{default:r(()=>[i(F,null,{default:r(()=>[i(k,{style:{"background-color":"#212121"},cols:"4"},{default:r(()=>[i(y,{"min-height":"35vh",rounded:"lg"},{default:r(()=>[i(t(de),{class:"chart",option:re.value,autoresize:""},null,8,["option"])]),_:1})]),_:1}),i(k,{style:{"background-color":"#212121"},cols:"8"},{default:r(()=>[i(y,{"min-height":"35vh",rounded:"lg"},{default:r(()=>[i(W,{modelValue:h.value,"onUpdate:modelValue":s[3]||(s[3]=e=>h.value=e),max:10,min:-10,step:1,"show-ticks":"always",ticks:{"-10":"Past",10:"Future"},"hide-spin-buttons":"",class:"align-center pb-2","hide-details":"",density:"compact","thumb-size":"12"},{prepend:r(()=>[i(O,{modelValue:le.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>le.value=e),s[1]||(s[1]=e=>e>0?0:2)],density:"compact",style:{width:"30px"},type:"number",variant:"underlined","hide-details":"","single-line":""},null,8,["modelValue"])]),append:r(()=>[i(O,{modelValue:ie.value,"onUpdate:modelValue":s[2]||(s[2]=e=>ie.value=e),density:"compact",style:{width:"30px"},type:"number",variant:"underlined","hide-details":"","single-line":""},null,8,["modelValue"])]),_:1},8,["modelValue"]),i(t(de),{class:"chart",option:H.value,autoresize:""},null,8,["option"])]),_:1})]),_:1})]),_:1})]),_:1}),i(k,{cols:"12"},{default:r(()=>[m("div",et,[i(y,{rounded:"lg",class:"pt-5"},{default:r(()=>[m("div",tt,[i(w,{rounded:"lg",variant:"tonal","prepend-icon":"mdi-plus",color:"primary",onClick:s[4]||(s[4]=e=>t(x).open({isFromDuplicate:!0}))},{default:r(()=>s[8]||(s[8]=[C(" Add New ")])),_:1})]),i(D,{density:"compact","row-props":Te,headers:t(u).headers.value,loading:t(u).loader.value,items:t(u).response.value,"item-value":"Id","item-class":"custom-row-class"},{"item.status":r(({item:e})=>[m("span",{class:z(T(e.status,t(n).Failed)?"underline":""),onClick:_=>T(e.status,t(n).Failed)?t(N).open({...new(t(Se)),title:"Exception Details",text:JSON.stringify(JSON.parse(e.exception),null,2),showConfirm:!1,maxWidth:"800",icon:"mdi-bug-outline",isCode:!0}):null},[m("span",null,b(e.status),1),T(e.status,t(n).Failed)?(v(),U(I,{key:0,class:"ml-2 mb-1",size:"small"},{default:r(()=>s[9]||(s[9]=[C("mdi-bug-outline")])),_:1})):Q("",!0)],10,st)]),"item.RequestType":r(({item:e})=>[i(Y,Re(ve.value.find(_=>_.id==e.id)??{icon:"mdi-cursor-default-click-outline",color:"#212121",style:"{color: #212121}"},{class:"custom-icon"}),{default:r(()=>[m("p",{class:"blue-underline mr-3",onClick:_=>t(P).open({id:e.id})},b(e.requestType),9,at)]),_:2},1040)]),"item.ExecutedAt":r(({item:e})=>[T(e.status,t(n).InProgress)?(v(),g("div",nt,s[10]||(s[10]=[m("div",{class:"stage"},[m("div",{class:"dot-carousel"})],-1)]))):(v(),g("div",ot,b(T(e.status,t(n).Cancelled)||T(e.status,t(n).Queued)?"N/A":e.executedAt),1))]),"item.retryIntervals":r(({item:e})=>[e.retryIntervals==null||e.retryIntervals.length==0?(v(),g("span",rt,s[11]||(s[11]=[m("span",null,"N/A",-1)]))):(v(),g("span",lt,[s[15]||(s[15]=C(" [ ")),(v(!0),g(ce,null,qe(e.retryIntervals,(_,R)=>(v(),g("span",{key:R},[m("span",{class:z(R==e.retryCount-1?e.status==t(n)[t(n).InProgress]?"interval interval-running":e.status!=t(n)[t(n).InProgress]||e.status!=t(n)[t(n).Idle]||e.status!=t(n)[t(n).Queued]?"active-attempt":"interval":"interval")},[m("span",it,"#"+b(R+1),1),s[12]||(s[12]=m("span",{class:"retry-preview"},"⇾",-1)),m("span",null,b(_),1)],2),R<e.retryIntervals.length-1?(v(),g("span",ct,", ")):Q("",!0)]))),128)),e.retries>e.retryIntervals.length?(v(),g("span",ut,[e.retryCount>e.retryIntervals.length&&e.retryCount!=e.retryIntervals.length&&e.retryCount!=e.retries?(v(),g("span",dt,[e.retryCount!=e.retryIntervals.length+1?(v(),g("span",pt,", ... ")):(v(),g("span",mt,", ")),m("span",{class:z(e.status==t(n)[t(n).InProgress]?"interval interval-running":e.status!=t(n)[t(n).InProgress]||e.status!=t(n)[t(n).Idle]||e.status!=t(n)[t(n).Queued]?"active-attempt":"interval")},[m("span",yt,"#"+b(e.retryCount),1),s[13]||(s[13]=m("span",{class:"retry-preview"},"⇾",-1)),m("span",null,b(e.retryIntervals[e.retryIntervals.length-1]),1)],2),e.retryCount+1!=e.retries?(v(),g("span",vt,", ...")):(v(),g("span",ft,", "))])):e.retries==2?(v(),g("span",gt,", ")):(v(),g("span",Tt,", ...")),m("span",{class:z(e.retryCount==e.retries?e.status==t(n)[t(n).InProgress]?"interval interval-running":e.status!=t(n)[t(n).InProgress]||e.status!=t(n)[t(n).Idle]||e.status!=t(n)[t(n).Queued]?"active-attempt":"interval":"interval")},[m("span",kt,"#"+b(e.retries),1),s[14]||(s[14]=m("span",null,"⇾",-1)),m("span",null,b(e.retryIntervals[e.retryIntervals.length-1]),1)],2)])):Q("",!0),s[16]||(s[16]=C(" ] "))]))]),"item.lockHolder":r(({item:e})=>[C(b(e.lockHolder)+" ",1),e.lockHolder!="N/A"?(v(),U(d,{key:0,activator:"parent",location:"left"},{default:r(()=>[m("span",null,"Locked At: "+b(t(te)(e.lockedAt)),1)]),_:2},1024)):Q("",!0)]),"item.actions":r(({item:e})=>[i(w,{onClick:_=>fe(e.id),disabled:!T(e.status,t(n).InProgress),icon:"",variant:T(e.status,t(n).InProgress)?"elevated":"text",density:"comfortable"},{default:r(()=>[i(I,{color:T(e.status,t(n).InProgress)?"blue":"grey"},{default:r(()=>s[17]||(s[17]=[C("mdi-cancel")])),_:2},1032,["color"])]),_:2},1032,["onClick","disabled","variant"]),T(e.status,t(n).Queued)||T(e.status,t(n).Idle)?(v(),U(w,{key:0,icon:"",density:"comfortable",onClick:_=>t(x).open({...e,executionTime:t(ee)(e.executionTime),isFromDuplicate:!1})},{default:r(()=>[i(I,{color:"amber"},{default:r(()=>s[18]||(s[18]=[C("mdi-pencil")])),_:1})]),_:2},1032,["onClick"])):(v(),U(w,{key:1,icon:"",density:"comfortable",onClick:_=>t(x).open({...e,executionTime:t(ee)(e.executionTime),isFromDuplicate:!0})},{default:r(()=>[i(I,{color:"grey"},{default:r(()=>s[19]||(s[19]=[C("mdi-plus-box-multiple-outline")])),_:1})]),_:2},1032,["onClick"])),i(w,{onClick:_=>t(E).open({id:e.id}),disabled:T(e.status,t(n).InProgress),variant:T(e.status,t(n).InProgress)?"text":"elevated",icon:"",density:"comfortable"},{default:r(()=>[i(I,{color:"red"},{default:r(()=>s[20]||(s[20]=[C("mdi-delete")])),_:1})]),_:2},1032,["onClick","disabled","variant"])]),_:1},8,["headers","loading","items"])]),_:1})])]),_:1})]),_:1})]),_:1}),i(t(E).Component,{"is-open":t(E).isOpen,onClose:s[5]||(s[5]=e=>t(E).close()),onConfirm:ge},null,8,["is-open"]),i(t(P).Component,{onPushMatchType:ye,"dialog-props":t(P).propData,"is-open":t(P).isOpen,onClose:s[6]||(s[6]=e=>t(P).close())},null,8,["dialog-props","is-open"]),i(t(x).Component,{ref_key:"crudTimeTickerDialogRef",ref:ae,"dialog-props":t(x).propData,"is-open":t(x).isOpen,onClose:ne,onConfirm:ne},null,8,["dialog-props","is-open"]),i(t(N).Component,{"is-open":t(N).isOpen,onClose:s[7]||(s[7]=e=>t(N).close()),"dialog-props":t(N).propData},null,8,["is-open","dialog-props"])],64)}}}),At=Fe(_t,[["__scopeId","data-v-3c9ecd0e"]]),wt=Object.freeze(Object.defineProperty({__proto__:null,default:At},Symbol.toStringTag,{value:"Module"}));export{wt as T,J as t};
